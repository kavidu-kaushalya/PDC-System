<UserControl x:Class="PDC_System.UserManagerControl"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             FontFamily="{StaticResource CustomFont}"
             Foreground="{DynamicResource Forground}"
             MinWidth="1200" MinHeight="700">

    <Border Padding="30"
            CornerRadius="15"
            Background="{DynamicResource Background}"
            BorderBrush="{DynamicResource BorderBrush}"
            BorderThickness="1">

        <Grid>
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="*"/>
            </Grid.RowDefinitions>

            <!-- Header Section -->
            <StackPanel Grid.Row="0" Margin="0,0,0,30">
                <TextBlock Text="👤 User Management System"
                           FontSize="25
                           "
                           FontWeight="Bold"
                           Foreground="{DynamicResource Forground}"
                           Margin="0,0,0,8"/>
                <TextBlock Text="Manage user accounts and permissions for your PDC system"
                           FontSize="13
                           "
                           Opacity="0.7"
                           Foreground="{DynamicResource Forground}"/>
            </StackPanel>

            <!-- Navigation Tabs -->
            <Border Grid.Row="1" 
                    Background="{DynamicResource ThemeBackground}"
                    CornerRadius="10"
                    Padding="5"
                    Margin="0,0,0,25">
                <StackPanel Orientation="Horizontal">
                    <Button x:Name="BtnCreateUser" 
                            Content="➕ Create User"
                          
                            Width="180" 
                            Margin="5"
                           
                          
                            Click="BtnCreateUser_Click"
                            Style="{DynamicResource ActionButton}" 
                            Background="#FF129400"/>

                    <Button x:Name="BtnManageUsers" 
                            Content="👥 Manage Users"
                            
                            Width="180"
                            Click="BtnManageUsers_Click"
                            Style="{DynamicResource ActionButton}" 
                            Background="#FF1469FF"/>
                </StackPanel>
            </Border>

            <!-- Main Content Area -->
            <Grid Grid.Row="2">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="20"/>
                    <ColumnDefinition Width="450"/>
                </Grid.ColumnDefinitions>

                <!-- Users Management Panel (Left) -->
                <Border Grid.Column="0" 
                        x:Name="ManageUsersPanel" 
                        Visibility="Visible"
                        Background="{DynamicResource Background}"
                        BorderBrush="{DynamicResource BorderBrush}"
                        BorderThickness="1"
                        CornerRadius="12"
                        Padding="25">

                    <StackPanel>
                        <Grid Margin="0,0,0,20">
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="Auto"/>
                            </Grid.ColumnDefinitions>

                            <StackPanel Grid.Column="0">
                                <TextBlock Text="Existing Users"
                                           FontSize="20"
                                           FontWeight="Bold"
                                           Foreground="{DynamicResource Forground}"
                                           Margin="0,0,0,5"/>
                                <TextBlock Text="View and manage system user accounts"
                                           FontSize="14"
                                           Opacity="0.7"
                                           Foreground="{DynamicResource Forground}"/>
                            </StackPanel>

                            <Border Grid.Column="1"
                                    Background="{DynamicResource ThemeBackground}"
                                    CornerRadius="8"
                                    Padding="10,8">
                                <TextBlock x:Name="UserCountText"
                                           Text="0 Users"
                                           FontSize="12"
                                           FontWeight="SemiBold"
                                           Foreground="{DynamicResource Forground}"/>
                            </Border>
                        </Grid>

                        <!-- Enhanced DataGrid -->
                        <Border Background="{DynamicResource Background}"
                                BorderBrush="{DynamicResource BorderBrush}"
                                BorderThickness="1"
                                CornerRadius="10"
                                Padding="5">

                            <DataGrid x:Name="UsersDataGrid"
                                      AutoGenerateColumns="False"
                                      CanUserAddRows="False"
                                      CanUserDeleteRows="False"
                                      GridLinesVisibility="None"
                                      HeadersVisibility="Column"
                                      SelectionMode="Single"
                                      RowHeaderWidth="0"
                                      FontSize="13"
                                      Background="Transparent"
                                      BorderThickness="0"
                                      MinHeight="400"
                                      MaxHeight="500">

                                <DataGrid.Resources>
                                    <Style TargetType="DataGridColumnHeader">
                                        <Setter Property="Background" Value="{DynamicResource ThemeBackground}"/>
                                        <Setter Property="Foreground" Value="{DynamicResource Forground}"/>
                                        <Setter Property="FontWeight" Value="Bold"/>
                                        <Setter Property="FontSize" Value="13"/>
                                        <Setter Property="Height" Value="45"/>
                                        <Setter Property="BorderThickness" Value="0"/>
                                        <Setter Property="Padding" Value="12,8"/>
                                        <Setter Property="HorizontalContentAlignment" Value="Center"/>
                                    </Style>

                                    <Style TargetType="DataGridRow">
                                        <Setter Property="Background" Value="Transparent"/>
                                        <Setter Property="Height" Value="50"/>
                                        <Setter Property="Margin" Value="0,2"/>
                                        <Style.Triggers>
                                            <Trigger Property="IsMouseOver" Value="True">
                                                <Setter Property="Background" Value="{DynamicResource IsMouseOver}"/>
                                            </Trigger>
                                            <Trigger Property="IsSelected" Value="True">
                                                <Setter Property="Background" Value="#FF1469FF"/>
                                                <Setter Property="Foreground" Value="White"/>
                                            </Trigger>
                                        </Style.Triggers>
                                    </Style>

                                    <Style TargetType="DataGridCell">
                                        <Setter Property="BorderThickness" Value="0"/>
                                        <Setter Property="Padding" Value="8"/>
                                        <Setter Property="VerticalAlignment" Value="Center"/>
                                        <Setter Property="HorizontalAlignment" Value="Center"/>
                                        <Style.Triggers>
                                            <Trigger Property="IsSelected" Value="True">
                                                <Setter Property="Background" Value="Transparent"/>
                                                <Setter Property="Foreground" Value="White"/>
                                            </Trigger>
                                        </Style.Triggers>
                                    </Style>
                                </DataGrid.Resources>

                                <DataGrid.Columns>
                                    <DataGridTextColumn Header="👤 Username" 
                                                       Foreground="{DynamicResource Forground}"
                                                        Binding="{Binding Username}" 
                                                        Width="150"/>

                                    <DataGridCheckBoxColumn Header="🏠 Dashboard" 
                                                            
                                                            Binding="{Binding Dashbord}" 
                                                            Width="90"/>

                                    <DataGridCheckBoxColumn Header="📋 Order Check" 
                                                           
                                                            Binding="{Binding OderCheck}" 
                                                            Width="100"/>

                                    <DataGridCheckBoxColumn Header="🎯 Job Card" 
                                                           
                                                            Binding="{Binding Jobcard}" 
                                                            Width="90"/>

                                    <DataGridCheckBoxColumn Header="👥 Customer" 
                                                          
                                                            Binding="{Binding Customer}" 
                                                            Width="90"/>

                                    <DataGridCheckBoxColumn Header="💼 Employee" 
                                                           
                                                            Binding="{Binding Employee}" 
                                                            Width="90"/>

                                    <DataGridCheckBoxColumn Header="🔧 Admin" 
                                                          
                                                            Binding="{Binding Isadmin}" 
                                                            Width="80"/>

                                    <DataGridTemplateColumn Header="Actions" Width="140">
                                        <DataGridTemplateColumn.CellTemplate>
                                            <DataTemplate>
                                                <StackPanel Orientation="Horizontal" 
                                                            HorizontalAlignment="Center">
                                                    <Button Content="✏️"
                                                            ToolTip="Edit User"
                                                            Width="32" 
                                                            Height="32"
                                                            Margin="2,0"
                                                            Click="EditUser_Click"
                                                            Style="{DynamicResource ActionButton}"
                                                            Background="#FF1469FF"/>

                                                    <Button Content="🗑️"
                                                            ToolTip="Delete User"
                                                            Width="32" 
                                                            Height="32"
                                                            Margin="2,0"
                                                            Click="DeleteUser_Click"
                                                            Style="{DynamicResource DeleteActionButton}"
                                                            Background="Crimson"/>
                                                </StackPanel>
                                            </DataTemplate>
                                        </DataGridTemplateColumn.CellTemplate>
                                    </DataGridTemplateColumn>
                                </DataGrid.Columns>
                            </DataGrid>
                        </Border>
                    </StackPanel>
                </Border>

                <!-- Create/Edit User Panel (Right) -->
                <Border Grid.Column="2" 
        x:Name="CreateUserPanel" 
        Visibility="Collapsed"
        Background="{DynamicResource Background}"
        BorderBrush="{DynamicResource BorderBrush}"
        BorderThickness="1"
        CornerRadius="12"
        Padding="25">

                    <ScrollViewer VerticalScrollBarVisibility="Auto">
                        <StackPanel>
                            <!-- Panel Header -->
                            <Border Background="{DynamicResource ThemeBackground}"
                    CornerRadius="8"
                    Padding="15"
                    Margin="0,0,0,25">
                                <StackPanel>
                                    <TextBlock Text="➕ Create New User"
                               FontSize="18"
                               FontWeight="Bold"
                               Foreground="{DynamicResource Forground}"
                               Margin="0,0,0,5"/>
                                    <TextBlock Text="Fill in the details to create a new user account"
                               FontSize="12"
                               Opacity="0.7"
                               Foreground="{DynamicResource Forground}"/>
                                </StackPanel>
                            </Border>

                            <!-- User Details Section -->
                            <Border Background="{DynamicResource Background}"
                    BorderBrush="{DynamicResource BorderBrush}"
                    BorderThickness="1"
                    CornerRadius="8"
                    Padding="20"
                    Margin="0,0,0,20">

                                <StackPanel>
                                    <TextBlock Text="👤 User Details"
                               FontSize="16"
                               FontWeight="SemiBold"
                               Foreground="{DynamicResource Forground}"
                               Margin="0,0,0,15"/>

                                    <!-- Username -->
                                    <StackPanel Margin="0,0,0,15">
                                        <TextBlock Text="Username"
                                   FontSize="13"
                                   FontWeight="Medium"
                                   Foreground="{DynamicResource Forground}"
                                   Margin="0,0,0,5"/>
                                        <TextBox x:Name="TxtUser"
                                 Style="{DynamicResource TextBoxStyle}"
                                 Height="40"
                                 FontSize="14"/>
                                    </StackPanel>

                                    <!-- Password -->
                                    <StackPanel Margin="0,0,0,15">
                                        <TextBlock Text="Password"
                                   FontSize="13"
                                   FontWeight="Medium"
                                   Foreground="{DynamicResource Forground}"
                                   Margin="0,0,0,5"/>
                                        <PasswordBox x:Name="TxtPass"
                                     Height="40"
                                     FontSize="14"/>
                                    </StackPanel>
                                </StackPanel>
                            </Border>

                            <!-- Permissions Section -->
                            <Border Background="{DynamicResource Background}"
                    BorderBrush="{DynamicResource BorderBrush}"
                    BorderThickness="1"
                    CornerRadius="8"
                    Padding="20"
                    Margin="0,0,0,20">

                                <StackPanel>
                                    <TextBlock Text="🔐 Permissions Access"
                               FontSize="16"
                               FontWeight="SemiBold"
                               Foreground="{DynamicResource Forground}"
                               Margin="0,0,0,15"/>

                                    <!-- Basic Permissions -->
                                    <TextBlock Text="Basic Access"
                               FontSize="14"
                               FontWeight="Medium"
                               Foreground="{DynamicResource Forground}"
                               Opacity="0.8"
                               Margin="0,0,0,10"/>

                                    <Border 
                            CornerRadius="6"
                            Padding="15"
                            Margin="0,0,0,15">

                                        <Grid>
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="250"/>
                                                <ColumnDefinition Width="*"/>
                                            </Grid.ColumnDefinitions>
                                            <Grid.RowDefinitions>
                                                <RowDefinition Height="Auto"/>
                                                <RowDefinition Height="Auto"/>
                                                <RowDefinition Height="Auto"/>
                                                <RowDefinition Height="Auto"/>
                                                <RowDefinition Height="Auto"/>
                                            </Grid.RowDefinitions>

                                            <!-- Dashboard (Disabled) -->
                                            <TextBlock Grid.Row="0" Grid.Column="0"
                                       Text="🏠 Dashboard"
                                       Foreground="{DynamicResource Forground}"
                                       FontSize="13"
                                       VerticalAlignment="Center"
                                       Margin="0,8"/>
                                            <CheckBox Grid.Row="0" Grid.Column="1"
                                      x:Name="Dashbord"
                                      IsChecked="True"
                                      IsEnabled="False"
                                      VerticalAlignment="Center"
                                      Margin="0,8"/>

                                            <!-- Order Check -->
                                            <TextBlock Grid.Row="1" Grid.Column="0"
                                       Text="📋 Order Check"
                                       Foreground="{DynamicResource Forground}"
                                       FontSize="13"
                                       VerticalAlignment="Center"
                                       Margin="0,8"/>
                                            <CheckBox Grid.Row="1" Grid.Column="1"
                                      x:Name="ChkOderCheck"
                                      VerticalAlignment="Center"
                                      Margin="0,8"/>

                                            <!-- Job Card -->
                                            <TextBlock Grid.Row="2" Grid.Column="0"
                                       Text="🎯 Job Card"
                                       Foreground="{DynamicResource Forground}"
                                       FontSize="13"
                                       VerticalAlignment="Center"
                                       Margin="0,8"/>
                                            <CheckBox Grid.Row="2" Grid.Column="1"
                                      x:Name="ChkJobcard"
                                      VerticalAlignment="Center"
                                      Margin="0,8"/>

                                            <!-- Customer Management -->
                                            <TextBlock Grid.Row="3" Grid.Column="0"
                                       Text="👥 Customer Management"
                                       Foreground="{DynamicResource Forground}"
                                       FontSize="13"
                                       VerticalAlignment="Center"
                                       Margin="0,8"/>
                                            <CheckBox Grid.Row="3" Grid.Column="1"
                                      x:Name="ChkCustomer"
                                      VerticalAlignment="Center"
                                      Margin="0,8"/>

                                            <!-- Quotation -->
                                            <TextBlock Grid.Row="4" Grid.Column="0"
                                       Text="💰 Quotation"
                                       Foreground="{DynamicResource Forground}"
                                       FontSize="13"
                                       VerticalAlignment="Center"
                                       Margin="0,8"/>
                                            <CheckBox Grid.Row="4" Grid.Column="1"
                                      x:Name="ChkQuotation"
                                      VerticalAlignment="Center"
                                      Margin="0,8"/>
                                        </Grid>

                                    </Border>

                                    <!-- Advanced Permissions -->
                                    <TextBlock Text="Advanced Access"
                               FontSize="14"
                               FontWeight="Medium"
                               Foreground="{DynamicResource Forground}"
                               Opacity="0.8"
                               Margin="0,10,0,10"/>

                                    <Border Background="{DynamicResource ThemeBackground}"
                            CornerRadius="6"
                            Padding="15"
                            Margin="0,0,0,15">

                                        <Grid>
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="250"/>
                                                <ColumnDefinition Width="*"/>
                                            </Grid.ColumnDefinitions>
                                            <Grid.RowDefinitions>
                                                <RowDefinition Height="Auto"/>
                                                <RowDefinition Height="Auto"/>
                                                <RowDefinition Height="Auto"/>
                                                <RowDefinition Height="Auto"/>
                                                <RowDefinition Height="Auto"/>
                                                <RowDefinition Height="Auto"/>
                                            </Grid.RowDefinitions>

                                            <!-- Outsourcing -->
                                            <TextBlock Grid.Row="0" Grid.Column="0"
                                       Text="🏢 Outsourcing"
                                       Foreground="{DynamicResource Forground}"
                                       FontSize="13"
                                       VerticalAlignment="Center"
                                       Margin="0,8"/>
                                            <CheckBox Grid.Row="0" Grid.Column="1"
                                      x:Name="ChkOutsourcing"
                                      VerticalAlignment="Center"
                                      Margin="0,8"/>

                                            <!-- Employee Management -->
                                            <TextBlock Grid.Row="1" Grid.Column="0"
                                       Text="👤 Employee Management"
                                       Foreground="{DynamicResource Forground}"
                                       FontSize="13"
                                       VerticalAlignment="Center"
                                       Margin="0,8"/>
                                            <CheckBox Grid.Row="1" Grid.Column="1"
                                      x:Name="ChkEmployee"
                                      VerticalAlignment="Center"
                                      Margin="0,8"/>

                                            <!-- Attendance -->
                                            <TextBlock Grid.Row="2" Grid.Column="0"
                                       Text="📅 Attendance"
                                       Foreground="{DynamicResource Forground}"
                                       FontSize="13"
                                       VerticalAlignment="Center"
                                       Margin="0,8"/>
                                            <CheckBox Grid.Row="2" Grid.Column="1"
                                      x:Name="ChkAttendance"
                                      VerticalAlignment="Center"
                                      Margin="0,8"/>

                                            <!-- Payroll Management -->
                                            <TextBlock Grid.Row="3" Grid.Column="0"
                                       Text="💳 Payroll Management"
                                       Foreground="{DynamicResource Forground}"
                                       FontSize="13"
                                       VerticalAlignment="Center"
                                       Margin="0,8"/>
                                            <CheckBox Grid.Row="3" Grid.Column="1"
                                      x:Name="ChkPayroll"
                                      VerticalAlignment="Center"
                                      Margin="0,8"/>

                                            <!-- Paysheet -->
                                            <TextBlock Grid.Row="4" Grid.Column="0"
                                       Text="📊 Paysheet"
                                       Foreground="{DynamicResource Forground}"
                                       FontSize="13"
                                       VerticalAlignment="Center"
                                       Margin="0,8"/>
                                            <CheckBox Grid.Row="4" Grid.Column="1"
                                      x:Name="ChkPaysheet"
                                      VerticalAlignment="Center"
                                      Margin="0,8"/>

                                            <!-- Admin (Highlighted) -->
                                            <Border Grid.Row="5" Grid.Column="0" Grid.ColumnSpan="2"
                                    Background="#FF1469FF"
                                    CornerRadius="6"
                                    Padding="8"
                                    Margin="0,8">
                                                <Grid>
                                                    <Grid.ColumnDefinitions>
                                                        <ColumnDefinition Width="235"/>
                                                        <ColumnDefinition Width="*"/>
                                                    </Grid.ColumnDefinitions>

                                                    <TextBlock Grid.Column="0"
                                               Text="🔧 System Administrator"
                                               Foreground="White"
                                               FontWeight="SemiBold"
                                               FontSize="13"
                                               VerticalAlignment="Center"/>
                                                    <CheckBox Grid.Column="1"
                                              x:Name="ChkIsAdmin"
                                              VerticalAlignment="Center"/>
                                                </Grid>
                                            </Border>

                                        </Grid>

                                    </Border>
                                </StackPanel>
                            </Border>

                            <!-- Action Buttons -->
                            <Border Background="{DynamicResource ThemeBackground}"
                    CornerRadius="8"
                    Padding="15">

                                <StackPanel Orientation="Horizontal" 
                            HorizontalAlignment="Center">
                                    <Button x:Name="BtnCreateSave" 
                            Content="✅ Create User"
                            Width="140" 
                            Height="45"
                            Margin="0,0,15,0"
                            FontSize="14"
                            FontWeight="SemiBold"
                            Click="CreateSave_Click"
                            Style="{DynamicResource ActionButton}"
                            Background="#FF129400"/>

                                    <Button x:Name="BtnClear" 
                            Content="❌ Cancel"
                            Width="100"
                            Height="45"
                            FontSize="14"
                            FontWeight="SemiBold"
                            Click="Clear_Click"
                            Style="{DynamicResource NavigationButtonStyle}"/>
                                </StackPanel>
                            </Border>
                        </StackPanel>
                    </ScrollViewer>
                </Border>
            </Grid>
        </Grid>
    </Border>
</UserControl>